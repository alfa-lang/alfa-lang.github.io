

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-146018870-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>flatMap &mdash; ALFA</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/alfa-a.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../../',
              VERSION:'1.0.0',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/alfa-theme.css" type="text/css" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="indexOf" href="indexOf.html" />
    <link rel="prev" title="decision table and bucketing" href="decisiontable.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html">
          

          
            
            <img src="../../../_static/AlfaLogo4c4c4c.svg" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../guide.html">Language Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../typesystem.html">Type System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../expressions.html">Expressions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../builtin-funcs.html">Builtin Functions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../builtin-funcs.html#collections">Collections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../builtin-funcs.html#construction">Construction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../builtin-funcs.html#conversion">Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../builtin-funcs.html#math">Math</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../builtin-funcs.html#generic">Generic</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="add.html">add</a></li>
<li class="toctree-l4"><a class="reference internal" href="contains.html">contains</a></li>
<li class="toctree-l4"><a class="reference internal" href="compare.html">compare</a></li>
<li class="toctree-l4"><a class="reference internal" href="decisiontable.html">decision table and bucketing</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">flatMap</a></li>
<li class="toctree-l4"><a class="reference internal" href="get.html">get</a></li>
<li class="toctree-l4"><a class="reference internal" href="indexOf.html">indexOf</a></li>
<li class="toctree-l4"><a class="reference internal" href="isNone.html">isNone</a></li>
<li class="toctree-l4"><a class="reference internal" href="isError.html">isError</a></li>
<li class="toctree-l4"><a class="reference internal" href="keyOf.html">keyOf</a></li>
<li class="toctree-l4"><a class="reference internal" href="join.html">join</a></li>
<li class="toctree-l4"><a class="reference internal" href="left.html">left</a></li>
<li class="toctree-l4"><a class="reference internal" href="len.html">len</a></li>
<li class="toctree-l4"><a class="reference internal" href="right.html">right</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../builtin-funcs.html#persisted-data">Persisted Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../builtin-funcs.html#string">String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../builtin-funcs.html#temporal">Temporal</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../otherfeatures.html">Other Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../exporters/exporters.html">Code Generators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../apis/runtimeapis.html">Runtime APIs &amp; Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../labs/labs.html">ALFA Labs</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Alfa</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../guide.html">Language Guide</a> &raquo;</li>
        
          <li><a href="../builtin-funcs.html">Builtin Functions</a> &raquo;</li>
        
      <li>flatMap</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="flatmap">
<span id="flatmapexpr"></span><h1>flatMap<a class="headerlink" href="#flatmap" title="Permalink to this headline">¶</a></h1>
<p>Allows safely extracting a value expressed as a path containing optional or try values.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">flatMap</span></code> allows concise and safe expressions avoiding the need to check if optional or try values have
valid values. Usage is not limited to optional and try type fields. Mandatory fields can also be traversed using <code class="docutils literal notranslate"><span class="pre">flatMap</span></code>.</p>
<p>Given the definition below:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">record</span> <span class="n">RecA</span> <span class="p">{</span>
   <span class="n">A</span> <span class="p">:</span> <span class="kt">int</span>
<span class="p">}</span>

<span class="k">record</span> <span class="n">RecB</span> <span class="p">{</span>
   <span class="n">B</span> <span class="p">:</span> <span class="k">try</span><span class="p">&lt;</span> <span class="n">RecA</span> <span class="p">&gt;</span>
<span class="p">}</span>

<span class="k">record</span> <span class="n">RecC</span> <span class="p">{</span>
   <span class="n">C</span> <span class="p">:</span> <span class="n">RecB</span><span class="p">?</span>

   <span class="n">assert</span> <span class="n">IsValid</span> <span class="p">{</span>
      <span class="k">let</span> <span class="n">optA</span> <span class="p">:</span> <span class="kt">int?</span> <span class="p">=</span> <span class="n">flatMap</span><span class="p">(</span> <span class="n">C</span><span class="p">.</span><span class="n">B</span><span class="p">.</span><span class="n">A</span> <span class="p">)</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Observe the use of <code class="docutils literal notranslate"><span class="pre">flatMap(</span> <span class="pre">C.B.A</span> <span class="pre">)</span></code>. <code class="docutils literal notranslate"><span class="pre">flatMap</span></code> allows traversing optional and try objects
to access a nested field. If there is <strong>no</strong> value present in the optional or try type field at any point in the nested
access, <code class="docutils literal notranslate"><span class="pre">flatMap</span></code> returns <code class="docutils literal notranslate"><span class="pre">none</span></code>. For example if C contained a <code class="docutils literal notranslate"><span class="pre">none</span></code> value or if B contained a failure value, a <code class="docutils literal notranslate"><span class="pre">none</span></code>
value is returned.</p>
<p>Without <code class="docutils literal notranslate"><span class="pre">flatmap</span></code>, <code class="docutils literal notranslate"><span class="pre">C.B.A</span></code> is an invalid expression as <code class="docutils literal notranslate"><span class="pre">C.B</span></code> is an invalid expression given <code class="docutils literal notranslate"><span class="pre">C</span></code> is an optional value.</p>
<p><strong>Parameters:</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">No.</th>
<th class="head">Type</th>
<th class="head">Comments</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>Any field, variable</td>
<td>Path to a nested field</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong>
<code class="docutils literal notranslate"><span class="pre">T</span></code>? - If the target field type is <code class="docutils literal notranslate"><span class="pre">T</span> <span class="pre">?</span></code>, the same type will be returned. If target is <code class="docutils literal notranslate"><span class="pre">T</span></code> ( not optional ), <code class="docutils literal notranslate"><span class="pre">T</span> <span class="pre">?</span></code> will be returned.</p>
<p><strong>Usages:</strong></p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">flatMap(</span> <span class="pre">Field1.NestedField1.NestedField2</span> <span class="pre">)</span> <span class="pre">:</span> <span class="pre">T</span> <span class="pre">?</span></code></li>
</ul>
</div></blockquote>
<p><strong>Example:</strong></p>
<p>Using <code class="docutils literal notranslate"><span class="pre">flatMap</span></code> to access value deeply nested within optional fields.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">assert</span> <span class="n">ValidDates</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">effective</span> <span class="p">=</span> <span class="n">flatMap</span><span class="p">(</span> <span class="n">EffectiveDate</span><span class="p">.</span><span class="n">UnadjustedDate</span><span class="p">.</span><span class="n">Value</span> <span class="p">)</span>
    <span class="k">let</span> <span class="n">termination</span> <span class="p">=</span> <span class="n">flatMap</span><span class="p">(</span> <span class="n">TerminationDate</span><span class="p">.</span><span class="n">UnadjustedDate</span><span class="p">.</span><span class="n">Value</span> <span class="p">)</span>

    <span class="k">return</span> <span class="nf">if</span> <span class="p">(</span> <span class="p">!</span><span class="n">isNone</span><span class="p">(</span><span class="n">effective</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="p">!</span><span class="n">isNone</span><span class="p">(</span><span class="n">termination</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">get</span><span class="p">(</span> <span class="n">effective</span> <span class="p">)</span> <span class="p">&gt;</span> <span class="n">get</span><span class="p">(</span> <span class="n">termination</span> <span class="p">)</span> <span class="p">)</span>
               <span class="n">some</span><span class="p">(</span><span class="s">&quot;Effective date ${effective} greater than Termination date ${termination}&quot;</span><span class="p">)</span>
           <span class="k">else</span>
               <span class="n">none</span>
<span class="p">}</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <center>
    <footer>
        <hr/>
        <div role="contentinfo">
            <p>
                    © Copyright 2020 Schemarise Ltd |
                    <a href='/legal/privacy.html'>Privacy</a> | 
                    <a href='/legal/terms.html'>Terms</a>
            </p>
        </div> 
    </footer>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/cookie-bar/cookiebar-latest.min.js?"></script>
</center> 
        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
